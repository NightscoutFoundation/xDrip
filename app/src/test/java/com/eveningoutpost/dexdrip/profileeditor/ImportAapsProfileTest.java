package com.eveningoutpost.dexdrip.profileeditor;

import static com.eveningoutpost.dexdrip.profileeditor.BasalProfile.consolidate;
import static com.google.common.truth.Truth.assertWithMessage;

import com.eveningoutpost.dexdrip.models.JoH;

import org.junit.Test;

import lombok.val;

public class ImportAapsProfileTest {

    private static final boolean D = false;
    private static final String treatment_json = "{\"eventType\":\"Profile Switch\",\"duration\":0,\"profile\":\"LocalProfile2\",\"profileJson\":\"{\\\"dia\\\":6,\\\"carbratio\\\":[{\\\"time\\\":\\\"00:00\\\",\\\"timeAsSeconds\\\":0,\\\"value\\\":12},{\\\"time\\\":\\\"07:00\\\",\\\"timeAsSeconds\\\":25200,\\\"value\\\":10},{\\\"time\\\":\\\"22:00\\\",\\\"timeAsSeconds\\\":79200,\\\"value\\\":12}],\\\"sens\\\":[{\\\"time\\\":\\\"00:00\\\",\\\"timeAsSeconds\\\":0,\\\"value\\\":4.5},{\\\"time\\\":\\\"07:00\\\",\\\"timeAsSeconds\\\":25200,\\\"value\\\":4},{\\\"time\\\":\\\"22:00\\\",\\\"timeAsSeconds\\\":79200,\\\"value\\\":4}],\\\"basal\\\":[{\\\"time\\\":\\\"00:00\\\",\\\"timeAsSeconds\\\":0,\\\"value\\\":0.4},{\\\"time\\\":\\\"03:00\\\",\\\"timeAsSeconds\\\":10800,\\\"value\\\":0.44},{\\\"time\\\":\\\"23:00\\\",\\\"timeAsSeconds\\\":82800,\\\"value\\\":0.4}],\\\"target_low\\\":[{\\\"time\\\":\\\"00:00\\\",\\\"timeAsSeconds\\\":0,\\\"value\\\":5}],\\\"target_high\\\":[{\\\"time\\\":\\\"00:00\\\",\\\"timeAsSeconds\\\":0,\\\"value\\\":6}],\\\"units\\\":\\\"mmol\\\",\\\"timezone\\\":\\\"Europe\\\\\\/London\\\"}\",\"created_at\":\"2022-04-26T17:43:39Z\",\"enteredBy\":\"AndroidAPS\",\"NSCLIENT_ID\":\"1650995021235\",\"mills\":1650995021242}\n";

    @Test
    public void importFromJsonTest() {
    }

    @Test
    public void importFromMapTest() {
        val tmap = JoH.JsonStringtoMap(treatment_json);

        assertWithMessage("not null 0").that(tmap).isNotNull();

        val pjo = ImportAapsProfile.importFromMap(tmap);

        assertWithMessage("not null 1").that(pjo).isNotNull();
        assertWithMessage("not null 2").that(pjo.basal).isNotNull();
        assertWithMessage("not null 3").that(pjo.carbratio).isNotNull();
        assertWithMessage("not null 4").that(pjo.sens).isNotNull();

        assertWithMessage("size 2").that(pjo.basal.size()).isEqualTo(3);
        assertWithMessage("size 3").that(pjo.carbratio.size()).isEqualTo(3);
        assertWithMessage("size 4").that(pjo.sens.size()).isEqualTo(3);

        if (D) {
            for (val item : pjo.basal) {
                System.out.println(item.toString());
            }
        }
        assertWithMessage("raw by minute matches").that(JoH.defaultGsonInstance().toJson(pjo.getBasalByMinute())).isEqualTo("[0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4000000059604645]");
        val redux = consolidate(pjo.getBasalByMinute(), 24);
        assertWithMessage("raw by hour matches").that(JoH.defaultGsonInstance().toJson(redux)).isEqualTo("[0.4000000059604645,0.4000000059604645,0.4000000059604645,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4399999976158142,0.4000000059604645]");
        val profile = pjo.getXdripMergedProfileList();
        assertWithMessage("standard profile maps").that(JoH.defaultGsonInstance().toJson(profile)).isEqualTo("[{\"day_of_week\":0,\"start_min\":0,\"end_min\":419,\"carb_ratio\":12.0,\"sensitivity\":4.5,\"absorption_rate\":0.0},{\"day_of_week\":0,\"start_min\":420,\"end_min\":1319,\"carb_ratio\":10.0,\"sensitivity\":4.0,\"absorption_rate\":0.0},{\"day_of_week\":0,\"start_min\":1320,\"end_min\":1439,\"carb_ratio\":12.0,\"sensitivity\":4.0,\"absorption_rate\":0.0}]");

    }
}